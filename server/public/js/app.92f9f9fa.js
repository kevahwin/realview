(function(){"use strict";var e={2536:function(e,t,n){var s=n(9963),o=n(6252);function i(e,t,n,s,i,a){const l=(0,o.up)("NavbarComponent"),r=(0,o.up)("MainComp"),c=(0,o.up)("SimpleUpload");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(l),(0,o.Wm)(r),(0,o.Wm)(c)])}const a=e=>((0,o.dD)("data-v-7702d0ed"),e=e(),(0,o.Cn)(),e),l=a((()=>(0,o._)("h3",null,"My Virtual Reality scene",-1))),r=a((()=>(0,o._)("canvas",null,null,-1))),c=[l,r];function d(e,t,n,s,i,a){return(0,o.wg)(),(0,o.iD)("div",null,c)}var p=n(7327),u=n(9498).xsS,h=n(9498).D4V,f=n(9498).Pa4,g=n(9498).ezm,m=n(9498).YfP,v=n(9498).BtG,b=n(9498).zHn,y=n(9498).BBM,w=n(9498).gZI,k=n(9498).n0n,x=document.getElementById("loadFile");x||(x=document.createElement("INPUT"),x.setAttribute("id","loadFile"),x.setAttribute("type","file"),x.style.position="absolute",x.style.top="80px",x.style.width="200px",x.style.height="100px",x.style.right="40px",document.body.children[0].appendChild(x)),n(8762),n(9626),n(6941);class P{constructor(e){(0,p.Z)(this,"scene",void 0),(0,p.Z)(this,"engine",void 0),this.engine=new h(e,!0),this.scene=this.CreateScene();const t=k.ImportMesh("","./models/","item.glb"),n=t.meshes;console.log("meshes",n);const s=new g("hemiLight",new f(0,1,0),this.scene);s.intensity=.5;const o=new m("Camera",-Math.PI/4*3,Math.PI/4,10,new f(0,0,0),this.scene);o.attachControl(!0),this.initXR(),this.engine.runRenderLoop((()=>{this.scene.render()}))}CreateScene(){const e=new u(this.engine);return e}async initXR(){const e=v.CreateFromPrefilteredData("./environment/environment.env",this.scene),t=new w({groundOpacity:.75},this.scene);t.skybox?.dispose(),t.ground.scaling=new f(5,5,5),t.ground.position.y=-1.1,t.ground.isPickable=!1,this.scene.createDefaultSkybox(e,!0);const n=await y.CreateAsync(this.scene,{floorMeshes:[t.ground],optionalFeatures:!0}),s=new b(new f,new f,3),o=new f(new f,new f,3),i=new f(new f,new f,3);let a,l;n.input.onControllerAddedObservable.add((e=>{e.onMotionControllerInitObservable.add((t=>{if("right"===t.handness){const n=t.getComponentIds(),r=t.getComponent(n[0]);r.onButtonStateChangedObservable.add((()=>{r.value>.5?(e.getWorldPointerRayToRef(s,!1),a=this.scene.pickWithRay(s),a&&void 0!==a.pickedMesh&&a.pickedMesh&&(l=a.pickedMesh,console.log("name:"+a.pickedMesh.name),l.setParent(t.rootMesh))):r.value<.5&&void 0!=l&&l.setParent(null)}));const c=t.getComponent(n[3]);c.onButtonStateChangedObservable.add((()=>{c.pressed&&(e.getWorldPointerRayToRef(o,!1),a=this.scene.pickWithRay(o),a&&a.pickedMesh&&a.pickedMesh&&(a.pickedMesh.scaling.x*=.9,a.pickedMesh.scaling.y*=.9,a.pickedMesh.scaling.z*=.9))}));const d=t.getComponent(n[4]);d.onButtonStateChangedObservable.add((()=>{d.pressed&&(e.getWorldPointerRayToRef(i,!1),a=this.scene.pickWithRay(i),a&&a.pickedMesh&&a.pickedMesh&&(a.pickedMesh.scaling.x*=1.1,a.pickedMesh.scaling.y*=1.1,a.pickedMesh.scaling.z*=1.1))}))}}))}))}}var C={name:"mainComp",mounted(){const e=document.querySelector("canvas");new P(e)}},_=n(3744);const S=(0,_.Z)(C,[["render",d],["__scopeId","data-v-7702d0ed"]]);var M=S;const D={class:"navbar navbar-expand-lg navbar-light bg-light fixed-top"},T=(0,o.uE)('<a class="navbar-brand" href="#">RealView</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNav"><ul class="navbar-nav"><li class="nav-item active"><a class="nav-link" href="#">Home <span class="sr-only"></span></a></li><li class="nav-item"><a class="nav-link" href="#">Portfolio</a></li><div class="flex-grow"></div></ul><div><button class="btn btn-outline-success my-2 my-sm-0" style="color:#AE98BD;border-color:#AE98BD;">Login</button></div></div>',3),O=[T];function I(e,t){return(0,o.wg)(),(0,o.iD)("nav",D,O)}const A={},R=(0,_.Z)(A,[["render",I]]);var E=R,F=n(3577);const j=e=>((0,o.dD)("data-v-72d39a70"),e=e(),(0,o.Cn)(),e),z={class:"message-body"},B={class:"field"},N={class:"file is-boxed is-primary"},Z={class:"file-label"},W=j((()=>(0,o._)("span",{class:"file-cta"},[(0,o._)("span",{class:"file-icon"},[(0,o._)("i",{class:"fas fa-upload"})])],-1))),$=["disabled"],L=j((()=>(0,o._)("hr",null,null,-1))),U={key:0,class:"error"},H={class:"posts-container"},q=["item","index","onDblclick"],G={class:"text"},V=["onClick"],Y=["onClick"];function X(e,t,n,i,a,l){return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("form",{onSubmit:t[3]||(t[3]=(0,s.iM)(((...e)=>l.sendFile&&l.sendFile(...e)),["prevent"])),enctype:"multipart/form-data"},[a.message?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,F.C_)("message "+(a.error?"is-danger":"is-success"))},[(0,o._)("div",z,(0,F.zw)(a.message),1)],2)):(0,o.kq)("",!0),(0,o._)("div",B,[(0,o._)("div",N,[(0,o._)("label",Z,[(0,o._)("input",{type:"file",ref:"file",onChange:t[0]||(t[0]=(...e)=>l.selectFile&&l.selectFile(...e)),class:"file-input"},null,544),W])])]),(0,o.wy)((0,o._)("input",{type:"text",id:"create-post","onUpdate:modelValue":t[1]||(t[1]=e=>a.text=e),placeholder:"Name your file"},null,512),[[s.nr,a.text]]),(0,o._)("button",{class:"button is-info",onClick:t[2]||(t[2]=(...e)=>l.createPost&&l.createPost(...e)),disabled:a.uploading},(0,F.zw)(a.uploading?"Uploading...":"Send"),9,$)],32),L,(0,o._)("button",{onClick:t[4]||(t[4]=(...e)=>l.addAllToScene&&l.addAllToScene(...e))}," Display All Objects "),a.error?((0,o.wg)(),(0,o.iD)("p",U,(0,F.zw)(a.error),1)):(0,o.kq)("",!0),(0,o._)("div",H,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.posts,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{class:"post",item:e,index:t,key:e._id,onDblclick:t=>l.deletePost(e._id,e.post_id)},[(0,o._)("p",G,(0,F.zw)(e.text),1),(0,o._)("button",{class:"addButton",onClick:t=>{l.addToScene2(e),l.addToScene(e)}},"Add To Scene",8,V)],40,q)))),128))]),(0,o._)("ul",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.items,((e,t)=>((0,o.wg)(),(0,o.iD)("li",{key:t},[(0,o.Uk)((0,F.zw)(a.itemName)+(0,F.zw)(t+1)+" ",1),(0,o._)("button",{onClick:e=>{l.addToScene(t),l.addToScene2(t)}},"Add to Scene",8,Y)])))),128))])],64)}n(7658);var K=n(8433);const J="api/posts/";class Q{static getPosts(){return new Promise((async(e,t)=>{try{const t=await K.Z.get(J),n=t.data;e(n.map((e=>({...e,createdAt:new Date(e.createdAt)}))))}catch(n){t(n)}}))}static insertPost(e){return K.Z.post(J,{text:e})}static deletePost(e){return K.Z["delete"](`${J}${e}`)}}var ee=Q,te=n(9498).n0n,ne={name:"SimpleUpload",data(){return{file:"",message:"",error:!1,itemName:"",items:[],posts:[],text:"",post_id:"",uploading:!1}},async created(){try{this.posts=await ee.getPosts()}catch(e){this.error=e.message}},methods:{selectFile(){this.file=this.$refs.file.files[0],this.fileExtension=this.file.name.split(".").pop().toLowerCase(),this.error=!1,this.message=""},async createPost(){if(!this.text)return void(this.error="Please enter some text for the post");if(!this.file)return void(this.error="Please select a file to upload");if("glb"!==this.fileExtension&&"obj"!==this.fileExtension)return void(this.error="Invalid file type. Please select a GLB file.");const e=this.text;await ee.insertPost(e),this.posts=await ee.getPosts()},async deletePost(e,t){await K.Z["delete"](`/api/uploads/${t}`),await ee.deletePost(e),this.posts=await ee.getPosts()},async sendFile(){this.uploading=!0;const e=new FormData;e.append("file",this.file),console.log("file:",this.file);try{if("glb"!==this.fileExtension&&"obj"!==this.fileExtension)throw new Error("Invalid file type. Please select a GLB file.");await K.Z.post("/api/uploads",e),this.message="File has been uploaded",this.file="",this.error=!1,this.$refs.file.value=null}catch(t){console.log(t),this.message=t.response.data.error,this.error=!0}finally{this.uploading=!1}},addToScene(e){console.log(),te.ImportMesh("","https://realviewtest1.s3.eu-west-2.amazonaws.com/models/",`${e.post_id}.obj`,this.$parent.scene,(function(e){var t=e[0];console.log(t)}))},addToScene2(e){console.log(),te.ImportMesh("","https://realviewtest1.s3.eu-west-2.amazonaws.com/models/",`${e.post_id}.glb`,this.$parent.scene,(function(e){var t=e[0];console.log(t)}))},addAllToScene(){for(let e=0;e<this.posts.length;e++)this.addToScene2(this.posts[e]),this.addToScene(this.posts[e])},listItem(){this.items.push({name:this.itemName}),this.itemName=""},getItem(){const e=new XMLHttpRequest;e.open("GET","http://localhost:5001/api/uploads/item",!0),e.responseType="document",e.onload=function(){if(e.readyState===e.DONE&&200===e.status){const t=e.response;console.log(t)}},e.send()}}};const se=(0,_.Z)(ne,[["render",X],["__scopeId","data-v-72d39a70"]]);var oe=se,ie={name:"App",components:{SimpleUpload:oe,MainComp:M,NavbarComponent:E}};const ae=(0,_.Z)(ie,[["render",i]]);var le=ae;n(1418);(0,s.ri)(le).mount("#app")}},t={};function n(s){var o=t[s];if(void 0!==o)return o.exports;var i=t[s]={exports:{}};return e[s].call(i.exports,i,i.exports,n),i.exports}n.m=e,function(){var e=[];n.O=function(t,s,o,i){if(!s){var a=1/0;for(d=0;d<e.length;d++){s=e[d][0],o=e[d][1],i=e[d][2];for(var l=!0,r=0;r<s.length;r++)(!1&i||a>=i)&&Object.keys(n.O).every((function(e){return n.O[e](s[r])}))?s.splice(r--,1):(l=!1,i<a&&(a=i));if(l){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[s,o,i]}}(),function(){n.d=function(e,t){for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,s){var o,i,a=s[0],l=s[1],r=s[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(o in l)n.o(l,o)&&(n.m[o]=l[o]);if(r)var d=r(n)}for(t&&t(s);c<a.length;c++)i=a[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(d)},s=self["webpackChunkclient"]=self["webpackChunkclient"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=n.O(void 0,[998],(function(){return n(2536)}));s=n.O(s)})();
//# sourceMappingURL=app.92f9f9fa.js.map