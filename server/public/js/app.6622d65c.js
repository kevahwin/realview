(function(){"use strict";var e={2536:function(e,t,n){var s=n(9963),i=n(6252);function o(e,t,n,s,o,a){const l=(0,i.up)("NavbarComponent"),r=(0,i.up)("MainComp"),c=(0,i.up)("SimpleUpload");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(l),(0,i.Wm)(r),(0,i.Wm)(c)])}const a=e=>((0,i.dD)("data-v-7702d0ed"),e=e(),(0,i.Cn)(),e),l=a((()=>(0,i._)("h3",null,"My Virtual Reality scene",-1))),r=a((()=>(0,i._)("canvas",null,null,-1))),c=[l,r];function d(e,t,n,s,o,a){return(0,i.wg)(),(0,i.iD)("div",null,c)}var p=n(7327),u=n(9498).xsS,h=n(9498).D4V,f=n(9498).Pa4,g=n(9498).ezm,m=n(9498).YfP,v=n(9498).BtG,b=n(9498).zHn,y=n(9498).gZI,w=n(9498).n0n,k=document.getElementById("loadFile");k||(k=document.createElement("INPUT"),k.setAttribute("id","loadFile"),k.setAttribute("type","file"),k.style.position="absolute",k.style.top="80px",k.style.width="200px",k.style.height="100px",k.style.right="40px",document.body.children[0].appendChild(k)),n(8762),n(9626),n(6941);class x{constructor(e){(0,p.Z)(this,"scene",void 0),(0,p.Z)(this,"engine",void 0),this.engine=new h(e,!0),this.scene=this.CreateScene();const t=w.ImportMesh("","./models/","item.glb"),n=t.meshes;console.log("meshes",n);const s=new g("hemiLight",new f(0,1,0),this.scene);s.intensity=.5;const i=new m("Camera",-Math.PI/4*3,Math.PI/4,10,new f(0,0,0),this.scene);i.attachControl(!0),this.initXR(),this.engine.runRenderLoop((()=>{this.scene.render()}))}CreateScene(){const e=new u(this.engine);return e}async initXR(){const e=v.CreateFromPrefilteredData("./environment/environment.env",this.scene),t=new y({groundOpacity:.75},this.scene);t.skybox?.dispose(),t.ground.scaling=new f(5,5,5),t.ground.position.y=-1.1,t.ground.isPickable=!1,this.scene.createDefaultSkybox(e,!0);const n=await this.scene.createDefaultXRExperienceAsync({floorMeshes:[t.ground]});if(!await n.baseExperience.sessionManager.supportsSessionAsync("immersive-vr")){const e=this.scene.createDefaultVRExperience();e.enableInteractions()}const s=new b(new f,new f,3),i=new f(new f,new f,3),o=new f(new f,new f,3);let a,l;n.input.onControllerAddedObservable.add((e=>{e.onMotionControllerInitObservable.add((t=>{if("right"===t.handness){const n=t.getComponentIds(),r=t.getComponent(n[0]);r.onButtonStateChangedObservable.add((()=>{r.value>.5?(e.getWorldPointerRayToRef(s,!1),a=this.scene.pickWithRay(s),a&&void 0!==a.pickedMesh&&a.pickedMesh&&(l=a.pickedMesh,console.log("name:"+a.pickedMesh.name),l.setParent(t.rootMesh))):r.value<.5&&void 0!=l&&l.setParent(null)}));const c=t.getComponent(n[3]);c.onButtonStateChangedObservable.add((()=>{c.pressed&&(e.getWorldPointerRayToRef(i,!1),a=this.scene.pickWithRay(i),a&&a.pickedMesh&&a.pickedMesh&&(a.pickedMesh.scaling.x*=.9,a.pickedMesh.scaling.y*=.9,a.pickedMesh.scaling.z*=.9))}));const d=t.getComponent(n[4]);d.onButtonStateChangedObservable.add((()=>{d.pressed&&(e.getWorldPointerRayToRef(o,!1),a=this.scene.pickWithRay(o),a&&a.pickedMesh&&a.pickedMesh&&(a.pickedMesh.scaling.x*=1.1,a.pickedMesh.scaling.y*=1.1,a.pickedMesh.scaling.z*=1.1))}))}}))}))}}var P={name:"mainComp",mounted(){const e=document.querySelector("canvas");new x(e)}},C=n(3744);const S=(0,C.Z)(P,[["render",d],["__scopeId","data-v-7702d0ed"]]);var _=S;const M={class:"navbar navbar-expand-lg navbar-light bg-light fixed-top"},D=(0,i.uE)('<a class="navbar-brand" href="#">RealView</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNav"><ul class="navbar-nav"><li class="nav-item active"><a class="nav-link" href="#">Home <span class="sr-only"></span></a></li><li class="nav-item"><a class="nav-link" href="#">Portfolio</a></li><div class="flex-grow"></div></ul><div><button class="btn btn-outline-success my-2 my-sm-0" style="color:#AE98BD;border-color:#AE98BD;">Login</button></div></div>',3),T=[D];function O(e,t){return(0,i.wg)(),(0,i.iD)("nav",M,T)}const E={},I=(0,C.Z)(E,[["render",O]]);var R=I,A=n(3577);const j=e=>((0,i.dD)("data-v-72d39a70"),e=e(),(0,i.Cn)(),e),z={class:"message-body"},F={class:"field"},N={class:"file is-boxed is-primary"},Z={class:"file-label"},B=j((()=>(0,i._)("span",{class:"file-cta"},[(0,i._)("span",{class:"file-icon"},[(0,i._)("i",{class:"fas fa-upload"})])],-1))),W=["disabled"],$=j((()=>(0,i._)("hr",null,null,-1))),L={key:0,class:"error"},U={class:"posts-container"},H=["item","index","onDblclick"],V={class:"text"},q=["onClick"],G=["onClick"];function X(e,t,n,o,a,l){return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("form",{onSubmit:t[3]||(t[3]=(0,s.iM)(((...e)=>l.sendFile&&l.sendFile(...e)),["prevent"])),enctype:"multipart/form-data"},[a.message?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,A.C_)("message "+(a.error?"is-danger":"is-success"))},[(0,i._)("div",z,(0,A.zw)(a.message),1)],2)):(0,i.kq)("",!0),(0,i._)("div",F,[(0,i._)("div",N,[(0,i._)("label",Z,[(0,i._)("input",{type:"file",ref:"file",onChange:t[0]||(t[0]=(...e)=>l.selectFile&&l.selectFile(...e)),class:"file-input"},null,544),B])])]),(0,i.wy)((0,i._)("input",{type:"text",id:"create-post","onUpdate:modelValue":t[1]||(t[1]=e=>a.text=e),placeholder:"Name your file"},null,512),[[s.nr,a.text]]),(0,i._)("button",{class:"button is-info",onClick:t[2]||(t[2]=(...e)=>l.createPost&&l.createPost(...e)),disabled:a.uploading},(0,A.zw)(a.uploading?"Uploading...":"Send"),9,W)],32),$,(0,i._)("button",{onClick:t[4]||(t[4]=(...e)=>l.addAllToScene&&l.addAllToScene(...e))}," Display All Objects "),a.error?((0,i.wg)(),(0,i.iD)("p",L,(0,A.zw)(a.error),1)):(0,i.kq)("",!0),(0,i._)("div",U,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.posts,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{class:"post",item:e,index:t,key:e._id,onDblclick:t=>l.deletePost(e._id,e.post_id)},[(0,i._)("p",V,(0,A.zw)(e.text),1),(0,i._)("button",{class:"addButton",onClick:t=>{l.addToScene2(e),l.addToScene(e)}},"Add To Scene",8,q)],40,H)))),128))]),(0,i._)("ul",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.items,((e,t)=>((0,i.wg)(),(0,i.iD)("li",{key:t},[(0,i.Uk)((0,A.zw)(a.itemName)+(0,A.zw)(t+1)+" ",1),(0,i._)("button",{onClick:e=>{l.addToScene(t),l.addToScene2(t)}},"Add to Scene",8,G)])))),128))])],64)}n(7658);var Y=n(8433);const K="api/posts/";class J{static getPosts(){return new Promise((async(e,t)=>{try{const t=await Y.Z.get(K),n=t.data;e(n.map((e=>({...e,createdAt:new Date(e.createdAt)}))))}catch(n){t(n)}}))}static insertPost(e){return Y.Z.post(K,{text:e})}static deletePost(e){return Y.Z["delete"](`${K}${e}`)}}var Q=J,ee=n(9498).n0n,te={name:"SimpleUpload",data(){return{file:"",message:"",error:!1,itemName:"",items:[],posts:[],text:"",post_id:"",uploading:!1}},async created(){try{this.posts=await Q.getPosts()}catch(e){this.error=e.message}},methods:{selectFile(){this.file=this.$refs.file.files[0],this.fileExtension=this.file.name.split(".").pop().toLowerCase(),this.error=!1,this.message=""},async createPost(){if(!this.text)return void(this.error="Please enter some text for the post");if(!this.file)return void(this.error="Please select a file to upload");if("glb"!==this.fileExtension&&"obj"!==this.fileExtension)return void(this.error="Invalid file type. Please select a GLB file.");const e=this.text;await Q.insertPost(e),this.posts=await Q.getPosts()},async deletePost(e,t){await Y.Z["delete"](`/api/uploads/${t}`),await Q.deletePost(e),this.posts=await Q.getPosts()},async sendFile(){this.uploading=!0;const e=new FormData;e.append("file",this.file),console.log("file:",this.file);try{if("glb"!==this.fileExtension&&"obj"!==this.fileExtension)throw new Error("Invalid file type. Please select a GLB file.");await Y.Z.post("/api/uploads",e),this.message="File has been uploaded",this.file="",this.error=!1,this.$refs.file.value=null}catch(t){console.log(t),this.message=t.response.data.error,this.error=!0}finally{this.uploading=!1}},addToScene(e){console.log(),ee.ImportMesh("","https://realviewtest1.s3.eu-west-2.amazonaws.com/models/",`${e.post_id}.obj`,this.$parent.scene,(function(e){var t=e[0];console.log(t)}))},addToScene2(e){console.log(),ee.ImportMesh("","https://realviewtest1.s3.eu-west-2.amazonaws.com/models/",`${e.post_id}.glb`,this.$parent.scene,(function(e){var t=e[0];console.log(t)}))},addAllToScene(){for(let e=0;e<this.posts.length;e++)this.addToScene2(this.posts[e]),this.addToScene(this.posts[e])},listItem(){this.items.push({name:this.itemName}),this.itemName=""},getItem(){const e=new XMLHttpRequest;e.open("GET","http://localhost:5001/api/uploads/item",!0),e.responseType="document",e.onload=function(){if(e.readyState===e.DONE&&200===e.status){const t=e.response;console.log(t)}},e.send()}}};const ne=(0,C.Z)(te,[["render",X],["__scopeId","data-v-72d39a70"]]);var se=ne,ie={name:"App",components:{SimpleUpload:se,MainComp:_,NavbarComponent:R}};const oe=(0,C.Z)(ie,[["render",o]]);var ae=oe;n(1418);(0,s.ri)(ae).mount("#app")}},t={};function n(s){var i=t[s];if(void 0!==i)return i.exports;var o=t[s]={exports:{}};return e[s].call(o.exports,o,o.exports,n),o.exports}n.m=e,function(){var e=[];n.O=function(t,s,i,o){if(!s){var a=1/0;for(d=0;d<e.length;d++){s=e[d][0],i=e[d][1],o=e[d][2];for(var l=!0,r=0;r<s.length;r++)(!1&o||a>=o)&&Object.keys(n.O).every((function(e){return n.O[e](s[r])}))?s.splice(r--,1):(l=!1,o<a&&(a=o));if(l){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[s,i,o]}}(),function(){n.d=function(e,t){for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,s){var i,o,a=s[0],l=s[1],r=s[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(i in l)n.o(l,i)&&(n.m[i]=l[i]);if(r)var d=r(n)}for(t&&t(s);c<a.length;c++)o=a[c],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(d)},s=self["webpackChunkclient"]=self["webpackChunkclient"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=n.O(void 0,[998],(function(){return n(2536)}));s=n.O(s)})();
//# sourceMappingURL=app.6622d65c.js.map